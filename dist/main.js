(()=>{"use strict";var e={d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{I:()=>h,n:()=>m});const t=(e,t)=>{const a=[];return{isSunk:()=>{if(a.filter((e=>"X"===e)).length==e)return!0},hit:()=>a.push("X"),name:t}},a=document.querySelector(".game-info"),r=document.querySelector(".text-info");let o="hori";function s(e){for(let t=0;t<10;t++)for(let a=0;a<10;a++)if(""!=e[t][a]){const e=document.getElementById(`${t}${a}`);e.classList.add("grid-cell-with-ship"),e.classList.remove("shadow")}}function n(e){r.textContent=`Player, place your ${e}.`}function l(e){let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());const r=document.getElementById(`${a}${t}`);if(""!=e.grid[a][t]&&"#ff4f56"!=r.style.backgroundColor){e.receiveAttack(t,a);const o=document.createElement("i");o.className="fa-solid fa-crosshairs",r.appendChild(o),r.style.backgroundColor="#ff4f56"}else if(""===e.grid[a][t]){const o=document.createElement("i");o.className="fa-solid fa-water",r.appendChild(o),e.grid[a][t]="O"}else l(e)}function d(e){const t=parseInt(e.target.dataset.x),a=parseInt(e.target.dataset.y);if(""!=m.grid[a][t]&&"#ff4f56"!=e.target.style.backgroundColor){const r=document.createElement("i");r.className="fa-solid fa-crosshairs",e.target.appendChild(r),e.target.style.backgroundColor="#ff4f56",m.receiveAttack(t,a),l(h)}else if(""===m.grid[a][t]){const r=document.createElement("i");r.className="fa-solid fa-water",e.target.appendChild(r),m.grid[a][t]="O",l(h)}else alert("This cell was already selected !")}const i=()=>{const e=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]];let t=0;const a=e=>""!=e;return{grid:e,placeShip:function(t,r,s,n){if("hori"==o){let o=[];for(let a=0;a<s;a++)o.push(e[r][t+a]);if(o.some(a))return;if(null!=e[r][t+(s-1)])for(let a=0;a<s;a++)e[r][t+a]=n}else if("vert"==o){let o=[];for(let a=0;a<s;a++)o.push(e[r+a][t]);if(o.some(a))return;if(null!=e[r+(s-1)][t])for(let a=0;a<s;a++)e[r+a][t]=n}},placeComputerShip:function t(r,o,s,n){const l=Math.floor(10*Math.random());if(l>4){let l=[];for(let t=0;t<s;t++)l.push(e[o][r+t]);if(l.some(a))t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),s,n);else if(null!=e[o][r+(s-1)])for(let t=0;t<s;t++)e[o][r+t]=n}else if(l<=4&&null!=e[o+(s-1)]){let l=[];for(let t=0;t<s;t++)l.push(e[o+t][r]);if(l.some(a))t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),s,n);else if(null!=e[o+(s-1)][r])for(let t=0;t<s;t++)e[o+t][r]=n}else t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),s,n)},receiveAttack:function(a,r){if(e[r][a].hit(),e[r][a].isSunk()){t+=1;const o=document.getElementById(e[r][a].name);o.style.textDecorationLine="line-through",o.style.color="#ff4f56"}5==t&&(alert("Game over"),document.querySelectorAll(".computer-grid-cell").forEach((e=>{e.removeEventListener("click",d)})))}}},c=document.getElementById("start"),f=document.querySelector(".game-info"),p=document.querySelector(".text-info"),h=i(),m=i(),u=t(5,"carrier"),g=t(5,"computer-carrier"),y=t(4,"battleship"),I=t(4,"computer-battleship"),M=t(3,"cruiser"),v=t(3,"computer-cruiser"),E=t(3,"submarine"),x=t(3,"computer-submarine"),L=t(2,"destroyer"),C=t(2,"computer-destroyer");let S=0,k=5;!function(){for(let e=0;e<10;e++)for(let t=0;t<10;t++){const a=document.getElementById("computer-grid"),r=document.createElement("div");r.classList.add("computer-grid-cell"),r.dataset.y=e,r.dataset.x=t,a.appendChild(r)}}(),function(){for(let e=0;e<10;e++)for(let t=0;t<10;t++){const a=document.getElementById("player-grid"),r=document.createElement("div");r.classList.add("player-grid-cell"),r.dataset.y=e,r.dataset.x=t,r.id=`${e}${t}`,a.appendChild(r)}}();const b=document.querySelectorAll(".player-grid-cell"),w=document.querySelectorAll(".computer-grid-cell");function q(e){if("vert"==o)for(let t=0;t<10*k;t+=10)null==b[parseInt(e.target.id)+10*(k-1)]?b[parseInt(e.target.id)+t].classList.add("shadow-wrong"):b[parseInt(e.target.id)+t].classList.add("shadow");else if(parseInt(e.target.dataset.x)+k>10)for(let t=0;t<10-parseInt(e.target.dataset.x);t++)b[parseInt(e.target.id)+t].classList.add("shadow-wrong");else for(let t=0;t<k;t++)b[parseInt(e.target.id)+t].classList.add("shadow")}function $(e){if("vert"==o)for(let t=0;t<10*k;t+=10)null==b[parseInt(e.target.id)+10*(k-1)]?b[parseInt(e.target.id)+t].classList.remove("shadow-wrong"):b[parseInt(e.target.id)+t].classList.remove("shadow");else if(parseInt(e.target.dataset.x)+k>10)for(let t=0;t<10-parseInt(e.target.dataset.x);t++)b[parseInt(e.target.id)+t].classList.remove("shadow-wrong");else for(let t=0;t<k;t++)b[parseInt(e.target.id)+t].classList.remove("shadow")}function A(e){switch(S){case 0:h.placeShip(parseInt(e.target.dataset.x),parseInt(e.target.dataset.y),5,u),s(h.grid),h.grid[parseInt(e.target.dataset.y)][parseInt(e.target.dataset.x)]==u&&(S+=1,k-=1,n("battleship"));break;case 1:h.placeShip(parseInt(e.target.dataset.x),parseInt(e.target.dataset.y),4,y),s(h.grid),h.grid[parseInt(e.target.dataset.y)][parseInt(e.target.dataset.x)]==y&&(S+=1,k-=1,n("cruiser"));break;case 2:h.placeShip(parseInt(e.target.dataset.x),parseInt(e.target.dataset.y),3,M),s(h.grid),h.grid[parseInt(e.target.dataset.y)][parseInt(e.target.dataset.x)]==M&&(S+=1,n("submarine"));break;case 3:h.placeShip(parseInt(e.target.dataset.x),parseInt(e.target.dataset.y),3,E),s(h.grid),h.grid[parseInt(e.target.dataset.y)][parseInt(e.target.dataset.x)]==E&&(S+=1,k-=1,n("destroyer"));break;case 4:h.placeShip(parseInt(e.target.dataset.x),parseInt(e.target.dataset.y),2,L),s(h.grid),h.grid[parseInt(e.target.dataset.y)][parseInt(e.target.dataset.x)]==L&&(S+=1,b.forEach((e=>{e.removeEventListener("mouseenter",q)})),b.forEach((e=>{e.removeEventListener("mouseleave",$)})),b.forEach((e=>{e.removeEventListener("click",A)})),f.textContent="",w.forEach((e=>{e.addEventListener("click",d)})));break;case 5:return}}c.addEventListener("click",(()=>{p.textContent="Player, place your carrier.",c.style.display="none",function(){const e=document.createElement("button");e.textContent="Change orientation",a.appendChild(e),e.addEventListener("click",(()=>{o="vert"==o?"hori":"vert"}))}(),b.forEach((e=>{e.addEventListener("mouseenter",q)})),b.forEach((e=>{e.addEventListener("mouseleave",$)})),b.forEach((e=>{e.addEventListener("click",A)}))})),m.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),5,g),m.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),4,I),m.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),3,v),m.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),3,x),m.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),2,C)})();