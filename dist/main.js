(()=>{"use strict";const e=(e,t)=>{const r=[];return{isSunk:()=>{if(r.filter((e=>"X"===e)).length==e)return!0},hit:()=>r.push("X"),name:t}},t=document.querySelector(".game-info"),r=document.querySelector(".text-info");let a="hori";function o(e){for(let t=0;t<10;t++)for(let r=0;r<10;r++)if(""!=e[t][r]){const e=document.getElementById(`${t}${r}`);e.classList.add("grid-cell-with-ship"),e.classList.remove("shadow")}}function n(e){r.textContent=`Player, place your ${e}.`}function s(e){let t=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());const a=document.getElementById(`${r}${t}`);if(""!=e.grid[r][t]&&"#ff4f56"!=a.style.backgroundColor){e.receiveAttack(t,r);const o=document.createElement("i");o.className="fa-solid fa-crosshairs",a.appendChild(o),a.style.backgroundColor="#ff4f56"}else if(""===e.grid[r][t]){const o=document.createElement("i");o.className="fa-solid fa-water",a.appendChild(o),e.grid[r][t]="O"}else s(e)}const l=()=>{const e=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]];let t=0;const r=e=>""!=e;return{grid:e,placeShip:function(t,o,n,s){if("hori"==a){let a=[];for(let r=0;r<n;r++)a.push(e[o][t+r]);if(a.some(r))return;if(null!=e[o][t+(n-1)])for(let r=0;r<n;r++)e[o][t+r]=s}else if("vert"==a){let a=[];for(let r=0;r<n;r++)a.push(e[o+r][t]);if(a.some(r))return;if(null!=e[o+(n-1)][t])for(let r=0;r<n;r++)e[o+r][t]=s}},placeComputerShip:function t(a,o,n,s){const l=Math.floor(10*Math.random());if(l>4){let l=[];for(let t=0;t<n;t++)l.push(e[o][a+t]);if(l.some(r))t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),n,s);else if(null!=e[o][a+(n-1)])for(let t=0;t<n;t++)e[o][a+t]=s}else if(l<=4&&null!=e[o+(n-1)]){let l=[];for(let t=0;t<n;t++)l.push(e[o+t][a]);if(l.some(r))t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),n,s);else if(null!=e[o+(n-1)][a])for(let t=0;t<n;t++)e[o+t][a]=s}else t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),n,s)},receiveAttack:function(r,a){if(e[a][r].hit(),e[a][r].isSunk()){t+=1;const o=document.getElementById(e[a][r].name);o.style.textDecorationLine="line-through",o.style.color="#ff4f56"}5==t&&alert("Game over")}}},i=document.getElementById("start"),d=document.querySelector(".game-info"),c=document.querySelector(".text-info"),f=l(),p=l(),h=e(5,"carrier"),m=e(5,"computer-carrier"),u=e(4,"battleship"),g=e(4,"computer-battleship"),y=e(3,"cruiser"),I=e(3,"computer-cruiser"),M=e(3,"submarine"),v=e(3,"computer-submarine"),x=e(2,"destroyer"),E=e(2,"computer-destroyer");let C=0,S=5;!function(){for(let e=0;e<10;e++)for(let t=0;t<10;t++){const r=document.getElementById("computer-grid"),a=document.createElement("div");a.classList.add("computer-grid-cell"),a.dataset.y=e,a.dataset.x=t,r.appendChild(a)}}(),function(){for(let e=0;e<10;e++)for(let t=0;t<10;t++){const r=document.getElementById("player-grid"),a=document.createElement("div");a.classList.add("player-grid-cell"),a.dataset.y=e,a.dataset.x=t,a.id=`${e}${t}`,r.appendChild(a)}}();const L=document.querySelectorAll(".player-grid-cell");function k(e){if("vert"==a)for(let t=0;t<10*S;t+=10)null==L[parseInt(e.target.id)+10*(S-1)]?L[parseInt(e.target.id)+t].classList.add("shadow-wrong"):L[parseInt(e.target.id)+t].classList.add("shadow");else if(parseInt(e.target.dataset.x)+S>10)for(let t=0;t<10-parseInt(e.target.dataset.x);t++)L[parseInt(e.target.id)+t].classList.add("shadow-wrong");else for(let t=0;t<S;t++)L[parseInt(e.target.id)+t].classList.add("shadow")}function w(e){if("vert"==a)for(let t=0;t<10*S;t+=10)null==L[parseInt(e.target.id)+10*(S-1)]?L[parseInt(e.target.id)+t].classList.remove("shadow-wrong"):L[parseInt(e.target.id)+t].classList.remove("shadow");else if(parseInt(e.target.dataset.x)+S>10)for(let t=0;t<10-parseInt(e.target.dataset.x);t++)L[parseInt(e.target.id)+t].classList.remove("shadow-wrong");else for(let t=0;t<S;t++)L[parseInt(e.target.id)+t].classList.remove("shadow")}function b(e){switch(C){case 0:f.placeShip(parseInt(e.target.x),parseInt(e.target.y),5,h),o(f.grid),f.grid[parseInt(e.target.y)][parseInt(e.target.x)]==h&&(C+=1,S-=1,n("battleship"));break;case 1:f.placeShip(parseInt(e.target.x),parseInt(e.target.y),4,u),o(f.grid),f.grid[parseInt(e.target.y)][parseInt(e.target.x)]==u&&(C+=1,S-=1,n("cruiser"));break;case 2:f.placeShip(parseInt(e.target.x),parseInt(e.target.y),3,y),o(f.grid),f.grid[parseInt(e.target.y)][parseInt(e.target.x)]==y&&(C+=1,n("submarine"));break;case 3:f.placeShip(parseInt(e.target.x),parseInt(e.target.y),3,M),o(f.grid),f.grid[parseInt(e.target.y)][parseInt(e.target.x)]==M&&(C+=1,S-=1,n("destroyer"));break;case 4:f.placeShip(parseInt(e.target.x),parseInt(e.target.y),2,x),o(f.grid),f.grid[parseInt(e.target.y)][parseInt(e.target.x)]==x&&(C+=1,S=0,d.textContent="",t=p,r=f,document.querySelectorAll(".computer-grid-cell").forEach((e=>{e.addEventListener("click",(()=>{let a=parseInt(e.dataset.x),o=parseInt(e.dataset.y);if(""!=t.grid[o][a]&&"#ff4f56"!=e.style.backgroundColor){const n=document.createElement("i");n.className="fa-solid fa-crosshairs",e.appendChild(n),e.style.backgroundColor="#ff4f56",t.receiveAttack(a,o),s(r)}else if(""===t.grid[o][a]){const n=document.createElement("i");n.className="fa-solid fa-water",e.appendChild(n),t.grid[o][a]="O",s(r)}else alert("This cell was already selected !")}))})));break;case 5:return}var t,r}i.addEventListener("click",(()=>{c.textContent="Player, place your carrier.",i.style.display="none",function(){const e=document.createElement("button");e.textContent="Change orientation",t.appendChild(e),e.addEventListener("click",(()=>{a="vert"==a?"hori":"vert"}))}(),L.forEach((e=>{e.addEventListener("mouseenter",k)})),L.forEach((e=>{e.addEventListener("mouseleave",w)})),L.forEach((e=>{e.addEventListener("click",b)}))})),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),5,m),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),4,g),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),3,I),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),3,v),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),2,E)})();