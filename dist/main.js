(()=>{"use strict";const e=(e,t)=>{const a=[];return{isSunk:()=>{if(a.filter((e=>"X"===e)).length==e)return!0},hit:()=>a.push("X"),name:t}},t=document.querySelector(".game-info"),a=document.querySelector(".text-info");let r="hori";function o(e){for(let t=0;t<10;t++)for(let a=0;a<10;a++)if(""!=e[t][a]){const e=document.getElementById(`${t}${a}`);e.classList.add("grid-cell-with-ship"),e.classList.remove("shadow")}}function s(e){a.textContent=`Player, place your ${e}.`}function n(e){let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());const r=document.getElementById(`${a}${t}`);if(""!=e.grid[a][t]&&"#ff4f56"!=r.style.backgroundColor){e.receiveAttack(t,a);const o=document.createElement("i");o.className="fa-solid fa-crosshairs",r.appendChild(o),r.style.backgroundColor="#ff4f56"}else if(""===e.grid[a][t]){const o=document.createElement("i");o.className="fa-solid fa-water",r.appendChild(o),e.grid[a][t]="O"}else n(e)}const l=()=>{const e=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]];let t=0;const a=e=>""!=e;return{grid:e,placeShip:function(t,o,s,n){if("hori"==r){let r=[];for(let a=0;a<s;a++)r.push(e[o][t+a]);if(r.some(a))return;if(null!=e[o][t+(s-1)])for(let a=0;a<s;a++)e[o][t+a]=n}else if("vert"==r){let r=[];for(let a=0;a<s;a++)r.push(e[o+a][t]);if(r.some(a))return;if(null!=e[o+(s-1)][t])for(let a=0;a<s;a++)e[o+a][t]=n}},placeComputerShip:function t(r,o,s,n){const l=Math.floor(10*Math.random());if(l>4){let l=[];for(let t=0;t<s;t++)l.push(e[o][r+t]);if(l.some(a))t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),s,n);else if(null!=e[o][r+(s-1)])for(let t=0;t<s;t++)e[o][r+t]=n}else if(l<=4&&null!=e[o+(s-1)]){let l=[];for(let t=0;t<s;t++)l.push(e[o+t][r]);if(l.some(a))t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),s,n);else if(null!=e[o+(s-1)][r])for(let t=0;t<s;t++)e[o+t][r]=n}else t(Math.floor(10*Math.random()),Math.floor(10*Math.random()),s,n)},receiveAttack:function(a,r){if(e[r][a].hit(),console.log(e[r][a]),e[r][a].isSunk()){t+=1;const o=document.getElementById(e[r][a].name);o.style.textDecorationLine="line-through",o.style.color="#ff4f56"}5==t&&alert("Game over")}}},d=document.getElementById("start"),i=document.querySelector(".game-info"),c=document.querySelector(".text-info"),f=l(),p=l(),h=e(5,"carrier"),m=e(5,"computer-carrier"),u=e(4,"battleship"),g=e(4,"computer-battleship"),y=e(3,"cruiser"),I=e(3,"computer-cruiser"),M=e(3,"submarine"),v=e(3,"computer-submarine"),x=e(2,"destroyer"),E=e(2,"computer-destroyer");let C=0,S=5;!function(){for(let e=0;e<10;e++)for(let t=0;t<10;t++){const a=document.getElementById("computer-grid"),r=document.createElement("div");r.classList.add("computer-grid-cell"),r.dataset.y=e,r.dataset.x=t,a.appendChild(r)}}(),function(){for(let e=0;e<10;e++)for(let t=0;t<10;t++){const a=document.getElementById("player-grid"),r=document.createElement("div");r.classList.add("player-grid-cell"),r.dataset.y=e,r.dataset.x=t,r.id=`${e}${t}`,a.appendChild(r)}}();const L=document.querySelectorAll(".player-grid-cell");d.addEventListener("click",(()=>{c.textContent="Player, place your carrier.",d.style.display="none",function(){const e=document.createElement("button");e.textContent="Change orientation",t.appendChild(e),e.addEventListener("click",(()=>{r="vert"==r?"hori":"vert"}))}(),L.forEach((e=>{e.addEventListener("mouseenter",(()=>{if("vert"==r)for(let t=0;t<10*S;t+=10)null==L[parseInt(e.id)+10*(S-1)]?L[parseInt(e.id)+t].classList.add("shadow-wrong"):L[parseInt(e.id)+t].classList.add("shadow");else if(parseInt(e.dataset.x)+S>10)for(let t=0;t<10-parseInt(e.dataset.x);t++)L[parseInt(e.id)+t].classList.add("shadow-wrong");else for(let t=0;t<S;t++)L[parseInt(e.id)+t].classList.add("shadow")}))})),L.forEach((e=>{e.addEventListener("mouseleave",(()=>{if("vert"==r)for(let t=0;t<10*S;t+=10)null==L[parseInt(e.id)+10*(S-1)]?L[parseInt(e.id)+t].classList.remove("shadow-wrong"):L[parseInt(e.id)+t].classList.remove("shadow");else if(parseInt(e.dataset.x)+S>10)for(let t=0;t<10-parseInt(e.dataset.x);t++)L[parseInt(e.id)+t].classList.remove("shadow-wrong");else for(let t=0;t<S;t++)L[parseInt(e.id)+t].classList.remove("shadow")}))})),L.forEach((e=>{e.addEventListener("click",(()=>{switch(C){case 0:f.placeShip(parseInt(e.dataset.x),parseInt(e.dataset.y),5,h),o(f.grid),f.grid[parseInt(e.dataset.y)][parseInt(e.dataset.x)]==h&&(C+=1,S-=1,s("battleship"));break;case 1:f.placeShip(parseInt(e.dataset.x),parseInt(e.dataset.y),4,u),o(f.grid),f.grid[parseInt(e.dataset.y)][parseInt(e.dataset.x)]==u&&(C+=1,S-=1,s("cruiser"));break;case 2:f.placeShip(parseInt(e.dataset.x),parseInt(e.dataset.y),3,y),o(f.grid),f.grid[parseInt(e.dataset.y)][parseInt(e.dataset.x)]==y&&(C+=1,s("submarine"));break;case 3:f.placeShip(parseInt(e.dataset.x),parseInt(e.dataset.y),3,M),o(f.grid),f.grid[parseInt(e.dataset.y)][parseInt(e.dataset.x)]==M&&(C+=1,S-=1,s("destroyer"));break;case 4:f.placeShip(parseInt(e.dataset.x),parseInt(e.dataset.y),2,x),o(f.grid),f.grid[parseInt(e.dataset.y)][parseInt(e.dataset.x)]==x&&(C+=1,S=0,i.textContent="",t=p,a=f,document.querySelectorAll(".computer-grid-cell").forEach((e=>{e.addEventListener("click",(()=>{let r=parseInt(e.dataset.x),o=parseInt(e.dataset.y);if(""!=t.grid[o][r]&&"#ff4f56"!=e.style.backgroundColor){const s=document.createElement("i");s.className="fa-solid fa-crosshairs",e.appendChild(s),e.style.backgroundColor="#ff4f56",t.receiveAttack(r,o),n(a)}else if(""===t.grid[o][r]){const s=document.createElement("i");s.className="fa-solid fa-water",e.appendChild(s),t.grid[o][r]="O",n(a)}else alert("This cell was already selected !")}))})));break;case 5:return}var t,a}))}))})),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),5,m),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),4,g),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),3,I),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),3,v),p.placeComputerShip(Math.floor(10*Math.random()),Math.floor(10*Math.random()),2,E)})();